---
import path from 'node:path';
import type { CollectionEntry } from 'astro:content';
import DocsHero from '~/components/navigation/docs-hero.astro';
import Pre from '~/components/pre.astro';
import { Prose } from '~/components/prose';
import DocsLayout from '~/layouts/docs.layout.astro';
import { getAllCollections } from '~/lib/page-control';
import { Code, Kbd, Link } from '@tacos-ui/react';

type Props = {
  entry: CollectionEntry<'components'> | CollectionEntry<'overview'>;
};

export async function getStaticPaths() {
  const collections = await getAllCollections();

  return collections.map((entry) => ({
    params: { slug: path.join(entry.collection, entry.data.id) },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<DocsLayout title={entry.data.title} description={entry.data.description}>
  <DocsHero slot="hero" entry={entry} />
  <Prose css={{ maxWidth: 'full', '&> :first-child': { mt: '0' } }}>
    <Content components={{ pre: Pre, code: Code, a: Link, kbd: Kbd }} />
  </Prose>
</DocsLayout>
